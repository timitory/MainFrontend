"use strict";(self["webpackChunkdashboard"]=self["webpackChunkdashboard"]||[]).push([[6293],{5248:function(t,e,a){a.r(e),a.d(e,{default:function(){return w}});var s=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"mt-8"},[s("div",{},[s("div",{staticClass:"overflow-x-auto xl:overflow-x-hidden tablecont"},[!t.$store.state.loading&&t.paginatedEnrollees.length>0?s("table",{staticClass:"w-full mt-8"},[t._m(0),s("tbody",t._l(t.paginatedEnrollees,(function(e){return s("tr",{key:e.id,staticClass:"border border-solid border-gray-300"},[s("td",[t._v(t._s(e.firstname))]),s("td",[t._v(t._s(e.surname))]),s("td",[t._v(t._s(e.email))]),"Completed"==e.status?s("td",{staticClass:"text-green-500"},[t._v(t._s(e.status))]):s("td",{staticClass:"text-red-500"},[t._v(t._s(e.status))]),"Completed"==e.status?s("td",{staticClass:"text-green-500"},[t._v("Added")]):s("td",{staticClass:"text-red-500"},[t._v(t._s(e.status))]),s("td",[s("button",{staticClass:"border border-solid rounded px-3 py-2 text-white text-center text-sm",staticStyle:{"background-color":"#A8004F"},on:{click:function(a){return t.updateEnrollee(e)}}},[t._v("Update")])])])})),0)]):!t.$store.state.loading&&t.paginatedEnrollees.length<1?s("div",{staticClass:"w-full text-center py-4"},[s("img",{staticClass:"block  mx-auto",attrs:{src:a(9190),alt:""}}),s("p",{staticClass:"mt-4 text-center font-bold text-green-500 font-lg"},[t._v("No records")])]):t._e(),t.paginatedEnrollees.length>0?s("nav",{staticClass:"mt-8",attrs:{"aria-label":"Page navigation example"}},[s("ul",{staticClass:"w-1/2 mx-auto  flex justify-between",staticStyle:{"max-width":"250px"}},[s("li",{staticClass:"page-item"},[1!=t.page?s("button",{staticClass:"inline text-green-500",attrs:{type:"button"},on:{click:function(e){t.page--}}},[t._v(" Previous ")]):s("button",{staticClass:"inline text-green-500 opacity-20"},[t._v("Previous")])]),s("li",{staticClass:"page-item"},[t.page<t.pages.length?s("button",{staticClass:"inline text-green-500",attrs:{type:"button"},on:{click:function(e){t.page++}}},[t._v(" Next ")]):s("button",{staticClass:"inline text-green-500 opacity-20"},[t._v("Next")])])])]):t._e()]),s("button",{staticClass:"mt-10 bg-green-500 text-white block lg:inline focus:outline-none px-4 py-2 lg:px-10 rounded float-right",class:[t.formValid?"":"opacity-30"],attrs:{disabled:!t.formValid},on:{click:t.submit}},[t._v("Proceed to payment")])]),t.showVirtual?s("VirtualAccount"):t._e(),t.showUpdateModal?s("UpdateEnrolleeModal",{attrs:{enrollee:t.selectedEnrollee},on:{close:t.closeUpdateModal,refresh:t.refreshList}}):t._e(),s("div",{directives:[{name:"show",rawName:"v-show",value:t.showPaystack,expression:"showPaystack"}]},[s("Paystack",{ref:"paystackbutton",staticClass:"hidden mt-6 w-full bg-green-500 text-white py-2 rounded outline-none focus:outline-none",attrs:{amount:t.paystackData.amount,email:t.paystackData.email,paystackkey:t.paystackData.public_key,reference:t.paystackData.reference,subaccount:t.paystackData.subaccount,transaction_charge:t.paystackData.transaction_charge,callback:t.verifyPayment,bearer:t.paystackData.bearer,close:t.closePayment}})],1),s("transition",{attrs:{name:"scale"}},[t.showMethodModal?s("PaymentMethod",{on:{useCard:t.payWithCard}}):t._e()],1)],1)},i=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("thead",[a("tr",[a("td",{staticClass:"font-bold"},[t._v("First name")]),a("td",{staticClass:"font-bold"},[t._v("Last name")]),a("td",{staticClass:"font-bold"},[t._v("Email")]),a("td",{staticClass:"font-bold"},[t._v("Preferred Hospital")]),a("td",{staticClass:"font-bold"},[t._v("Passport")]),a("td",{staticClass:"font-bold"},[t._v("Action")])])])}],o=(a(4114),a(2505)),n=a.n(o),r=a(850),l=a(1845),c=a(9401),d=a.n(c),u=a(968),h=a(5353),p=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"l-modal"},[a("div",{staticClass:"loading-modal w-full"},[a("div",{staticClass:"loader bg-white w-11/12 lg:w-8/12 mx-auto rounded p-5 lg:px-8 pb-6"},[t._m(0),a("div",{staticClass:"transfer-group"},[a("div",[a("label",[t._v("BANK NAME")]),a("p",[t._v(t._s(t.virtualAccount.bank_name))])]),a("div",[a("label",[t._v("ACCOUNT NUMBER")]),a("div",{staticClass:"transfer-pair"},[a("p",{staticClass:"account"},[t._v(t._s(t.virtualAccount.account_number))]),a("span",{on:{click:function(e){return t.copy("account")}}},[t._v(t._s(t.setCopied?"COPIED":"COPY"))])])]),a("div",[a("label",[t._v("ACCOUNT NAME")]),a("div",{staticClass:"transfer-pair"},[a("p",{staticClass:"accountName"},[t._v(t._s(t.virtualAccount.account_name))]),a("span",{on:{click:function(e){return t.copy("accountName")}}},[t._v(t._s(t.setCopiedName?"COPIED":"COPY"))])])]),a("div",[a("label",[t._v("AMOUNT")]),a("div",{staticClass:"transfer-pair"},[a("p",{staticClass:"amount"},[t._v(t._s(t.virtualAccount.amount))]),a("span",{on:{click:function(e){return t.copy("amount")}}},[t._v(t._s(t.setCop?"COPIED":"COPY"))])])])]),t._m(1),a("div",{staticClass:"next-box text-center",on:{click:function(e){return t.$router.push({name:"ManageHealth"})}}},[a("div",[t._v("Close")])])])])])},m=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"quotaion-title"},[a("h6",[t._v("Transfer Payment")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"transfer-instruct"},[a("p",[a("span",[t._v("INSTRUCTION:")]),t._v(" A policy can only be active when payment have been made ")])])}],v={components:{},data(){return{setCopied:!1,setCop:!1,setCopiedName:!1}},props:{},methods:{copy(t){if("account"===t){let t=document.querySelector(".account").innerHTML;navigator.clipboard.writeText(t),this.setCopied=!0,this.setCop=!1,this.setCopiedName=!1}else if("amount"===t){let t=document.querySelector(".amount").innerHTML;navigator.clipboard.writeText(t),this.setCopied=!1,this.setCop=!0,this.setCopiedName=!1}else{let t=document.querySelector(".accountName").innerHTML;navigator.clipboard.writeText(t),this.setCopied=!1,this.setCop=!1,this.setCopiedName=!0}}},mounted(){console.log(this.virtualAccount)},computed:{...(0,h.aH)({virtualAccount:t=>t.virtualAccount,user:t=>t.user})}},f=v,_=a(1656),g=(0,_.A)(f,p,m,!1,null,"0864d51b",null),y=g.exports,C={components:{VirtualAccount:y,Paystack:d(),PaymentMethod:u.A,UpdateEnrolleeModal:l.A},props:{reference:{required:!0},user_health_id:{required:!0}},data(){return{enrollees:[],page:1,perPage:10,pages:[],selectedEnrollee:{},showUpdateModal:!1,paystackData:{public_key:"",email:"",amount:0,reference:"",subaccount:"",bearer:"subaccount",transaction_charge:0},showPaystack:!1,showMethodModal:!1,formValid:!1,showVirtual:!1}},computed:{paginatedEnrollees(){return this.paginate(this.enrollees)},...(0,h.aH)({user:t=>t.user})},watch:{enrollees(){this.setPages()}},methods:{submit(){"Card"===localStorage.getItem("PaymentMode")?this.initiatePayment():this.showVirtual=!0},getUploadedBeneficiaries(){this.$store.commit("startLoading"),n().get(`${r.A}/health/bulkpolicy/${this.reference}`).then((t=>{this.$store.commit("endLoading"),this.enrollees=t.data.data,console.log(this.enrollees),this.checkStatus()})).catch((t=>{this.$store.dispatch("handleError",t)}))},setPages(){let t=Math.ceil(this.enrollees.length/this.perPage);for(let e=1;e<=t;e++)this.pages.push(e)},paginate(t){let e=this.page,a=this.perPage,s=e*a-a,i=e*a;return t.slice(s,i)},updateEnrollee(t){this.selectedEnrollee=t,this.showUpdateModal=!0},closeUpdateModal(){this.showUpdateModal=!1,this.selectedEnrollee={}},refreshList(){this.getUploadedBeneficiaries()},checkStatus(){this.enrollees.every((t=>"Completed"==t.status))&&(this.formValid=!0)},closePayment(){this.$store.commit("endLoading"),this.$store.commit("setError",{status:!0,msg:"Payment cancelled"})},verifyPayment(){n()({url:`${r.A}/hmo/payment/bulk/verify`,data:{reference:this.paystackData.reference},method:"POST"}).then((t=>{this.$store.commit("endLoading"),this.$store.commit("setSuccess",{status:!0,msg:t.data.message}),this.$router.push("/app/dashboard/managehealth")})).catch((t=>{this.$store.commit("endLoading"),this.$store.commit("setError",{status:!0,msg:t.response.data.message})}))},initiatePayment(){if(!this.user.has_card)return this.payNow();this.showMethodModal=!0},payNow(){this.$store.commit("startLoading");let t={reference:this.reference,user_health_id:629,card_id:0};n()({url:`${r.A}/hmo/payment/bulk/init`,data:t,method:"POST"}).then((t=>{this.showPaystack=!0,this.paystackData.public_key=t.data.data.public_key,this.paystackData.email=t.data.data.email,this.paystackData.amount=t.data.data.amount,this.paystackData.reference=t.data.data.reference,this.paystackData.subaccount=t.data.data.subaccount,this.paystackData.transaction_charge=t.data.data.flatfee,this.$refs.paystackbutton.payWithPaystack(this.paystackData)})).catch((t=>{this.$store.dispatch("handleError",t)}))},payWithCard(t){this.showMethodModal=!1,"old"===t?this.$router.push({name:"SelectHealthCard",query:{reference:this.reference}}):"new"===t&&this.payNow()}},mounted(){this.getUploadedBeneficiaries()}},b=C,k=(0,_.A)(b,s,i,!1,null,"8262ad14",null),w=k.exports}}]);
//# sourceMappingURL=6293.c0238c54.js.map